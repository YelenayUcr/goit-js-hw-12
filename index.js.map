{"version":3,"file":"index.js","sources":["../src/js/init.js","../src/main.js"],"sourcesContent":["window.global ||= window;\nimport '../main.js';\n","import './js/init';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport axios from 'axios';\n\nconst API_KEY = '48307401-677547b5d41e0bab8fbb923eb';\nconst baseUrl = 'https://pixabay.com/api/';\n\nconst searchParams = new URLSearchParams({\n  key: API_KEY,\n  q: '',\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: true,\n  per_page: 40,\n  page: 1,\n});\n\nlet totalHits = 0;\nconst message1 = \"Sorry, there are no images matching your search query. Please, try again!\";\nconst message2 = \"We're sorry, but you've reached the end of search results\";\nconst contentUL = document.querySelector('.image-content');\nconst loader = document.querySelector('.loader');\nconst loadMore = document.querySelector('.load-more-button');\n\nconst lightbox = new SimpleLightbox('.content-list-item a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nfunction scrollPage() {\n  let listItems = document.querySelector('.content-list-item');\n  if (listItems) {\n    let rect = listItems.getBoundingClientRect();\n    window.scrollBy({ top: rect.height * 2, behavior: 'smooth' });\n  }\n}\n\nfunction showError(errorMessage, bgcolor) {\n  iziToast.settings({\n    timeout: 5000,\n    transitionIn: 'flipInX',\n    transitionOut: 'flipOutX',\n  });\n  iziToast.show({\n    maxWidth: '350px',\n    message: `${errorMessage}`,\n    position: 'topRight',\n    backgroundColor: `${bgcolor}`,\n  });\n}\n\nfunction createMarkup(jsonData) {\n  const contentMarkup = jsonData.hits\n    .map(\n      ({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) =>\n        `<li class=\"content-list-item\">\n            <div class=\"container-div\">\n                <a href=\"${largeImageURL}\">\n                    <img src=\"${webformatURL}\" alt=\"${tags}\" width=\"240\" height=\"200\">\n                </a>\n                <div class=\"content-bottom\">\n                    <div class=\"content-bottom-inner\">\n                        <p><b>Likes</b></p>\n                        <p class=\"stats\">${likes}</p></div>\n                    <div class=\"content-bottom-inner\">\n                        <p><b>Views</b></p>\n                        <p class=\"stats\">${views}</p></div>\n                    <div class=\"content-bottom-inner\">\n                        <p><b>Comments</b></p>\n                        <p class=\"stats\">${comments}</p></div>\n                    <div class=\"content-bottom-inner\">\n                        <p><b>Downloads</b></p>\n                        <p class=\"stats\">${downloads}</p></div>\n                </div> \n            </div> \n        </li>`\n    )\n    .join('');\n\n  contentUL.insertAdjacentHTML('beforeend', contentMarkup);\n  lightbox.refresh();\n}\n\nasync function getData() {\n  try {\n    const response = await axios.get(baseUrl, { params: searchParams });\n    loader.style.display = 'none';\n    loadMore.style.display = 'none';\n    totalHits = response.data.totalHits;\n    if (totalHits === 0) {\n      showError(message1, 'red');\n    } else {\n      createMarkup(response.data);\n\n      const currentPage = Number(searchParams.get('page'));\n      const perPage = Number(searchParams.get('per_page'));\n\n      if (currentPage < Math.ceil(totalHits / perPage)) {\n        loadMore.style.display = 'block';\n      }\n      if (Math.ceil(totalHits / perPage) === 1) {\n        showError(message2, 'aqua');\n      }\n    }\n  } catch (error) {\n    loader.style.display = 'none';\n    showError(error.message, 'purple');\n  }\n}\n\nconst searchForm = document.querySelector('.search-form');\nconst searchInput = document.querySelector('.search-input');\n\nsearchForm.addEventListener('submit', event => {\n  event.preventDefault();\n  searchParams.set('q', searchInput.value);\n  searchParams.set('page', '1');\n  contentUL.innerHTML = '';\n  loader.style.display = 'flex';\n  getData();\n});\n\nloadMore.addEventListener('click', async () => {\n  let currentPage = Number(searchParams.get('page'));\n  let perPage = searchParams.get('per_page');\n  searchParams.set('page', currentPage + 1);\n\n  await getData();\n  scrollPage();\n\n  if (currentPage + 1 >= Math.ceil(totalHits / perPage)) {\n    showError(message2, 'aqua');\n    loadMore.style.display = 'none';\n  }\n});\n"],"names":["API_KEY","baseUrl","searchParams","totalHits","message1","message2","contentUL","loader","loadMore","lightbox","SimpleLightbox","scrollPage","listItems","rect","showError","errorMessage","bgcolor","iziToast","createMarkup","jsonData","contentMarkup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","getData","response","axios","currentPage","perPage","error","searchForm","searchInput","event"],"mappings":"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"}